<div class="list-container">
  <div class="toolbar" style="margin-bottom: 20px;">
    <div class="search-wrapper">
      <i class="bi bi-search search-icon"></i>
      <input type="text" [ngModel]="search" (keyup)="onSearchKeyup($event)" placeholder="Search students by name..."
        class="search-input-modern" />
    </div>

    <div class="header-stats">
      <span class="custom-badge bg-primary">Total Participants: {{totalCount}}</span>
    </div>
  </div>

  @if (!loading) {
  <div class="cards-grid">
    @for (student of participants; track student.userId) {
    <div class="course-card student-card">
      <div class="card-header">
        <img [src]="student.logoUrl || '/assets/default-avatar.png'"
          style="width: 60px; height: 60px; border-radius: 50%; object-fit: cover; border: 2px solid var(--sky-300);" />

        <div class="status-badge-container">
          @if(student.isPassed) {
          <span class="custom-badge bg-success"><i class="bi bi-check-circle"></i> Passed</span>
          } @else {
          <span class="custom-badge bg-danger"><i class="bi bi-x-circle"></i> Failed</span>
          }
        </div>
      </div>

      <div class="card-body">
        <h3 class="course-name">{{ student.fullName }}</h3>
        <a [routerLink]="[student.id, 'result']" class="btn-review">
          <i class="bi bi-eye"></i> View Result
        </a>
        <div class="exam-details" style="margin: 15px 0;">
          <div class="detail-row">
            <i class="bi bi-star-fill text-warning"></i>
            <strong>Score:</strong> {{ student.score }}%
          </div>
          <div class="detail-row">
            <i class="bi bi-arrow-repeat"></i>
            <strong>Attempts:</strong> {{ student.tryCount }}
          </div>
          <div class="detail-row">
            <i class="bi bi-calendar-check"></i>
            <strong>Finished:</strong> {{ student.finishedAt | date:'short' }}
          </div>
        </div>

        <div class="social-bar" style="border-top: 1px solid #eee; padding-top: 10px;">
          @if(student.isCertificateIssued) {
          <span class="text-success" style="font-weight: 600;">
            <i class="bi bi-patch-check-fill"></i> Certificate Issued
          </span>
          } @else {
          <span class="text-muted" style="font-size: 0.85rem;">
            <i class="bi bi-clock"></i> No Certificate
          </span>
          }

          <div style="flex: 1;"></div>

          <button class="btn btn-secondary" title="View Details" [routerLink]="[student.userId,'result']">
            <i class="bi bi-eye"></i>
          </button>
        </div>
      </div>
    </div>
    }
  </div>

  @if (participants.length === 0) {
  <div class="no-data">
    <i class="bi bi-people" style="font-size: 4rem; color: #ccc;"></i>
    <p>No students have taken this exam yet.</p>
  </div>
  }

  @if (totalCount > pageSize) {
  <div class="pagination-modern">
    <button class="page-nav" [disabled]="pageIndex === 1" (click)="onPageChange(pageIndex - 1)">
      <i class="bi bi-chevron-left"></i>
    </button>
    @for (p of pages; track p) {
    <button class="page-num" [class.active]="p === pageIndex" (click)="onPageChange(p)">{{ p }}</button>
    }
    <button class="page-nav" [disabled]="pageIndex === totalPages" (click)="onPageChange(pageIndex + 1)">
      <i class="bi bi-chevron-right"></i>
    </button>
  </div>
  }
  } @else {
  
  }
</div>